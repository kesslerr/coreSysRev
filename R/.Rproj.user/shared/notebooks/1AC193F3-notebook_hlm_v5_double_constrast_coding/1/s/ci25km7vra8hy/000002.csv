"0","# table for results"
"0","facesIntercept <- matrix(NA, 3, 3)"
"0","facesPVal      <- matrix(NA, 3, 3)"
"0","dfResults <- data.frame(Source=numeric(0), Target=numeric(0), Matrix=character(0), Type=character(0), Value=numeric(0), stringsAsFactors=FALSE)"
"0","bigDF <- data.frame(matrix(ncol=5,nrow=0, dimnames=list(NULL, c(""Subject"", ""Parameter"", ""Study"", ""Hormone"", ""Connection""))))"
"0",""
"0",""
"0","for ( target in 1:3 ){      # target region"
"0","  for ( source in 1:3 ){    # source region"
"0","    if (source == target){"
"0","      next # skip this iteration if it is a self connection"
"0","    } else {"
"0","      "
"0","      # load parameters in df"
"0","      Parameter <-      c(dfEFP$mEpsA[target,source,], # DCM parameters"
"0","                          dfFEM$mEpsA[target,source,],"
"0","                          dfCYM$mEpsA[target,source,],"
"0","                          dfCYP$mEpsA[target,source,],"
"0","                          dfWaH$mEpsA[target,source,])"
"0","      Subject <- c(subNumEFP, subNumFEM, subNumCYM, subNumCYP, subNumWaH)"
"0","      Study <- c(rep(0,23),rep(1,27), rep(2,16+17), rep(3,123))"
"0","      Hormone <-  c(rep(0,23+27+16), rep(1,17), rep(0,123))"
"0","      dfFaces <- data.frame(Subject, Parameter, Study, Hormone)"
"0","      dfFaces$Subject <- as.factor(dfFaces$Subject)"
"0","      dfFaces$Study   <- as.factor(dfFaces$Study)"
"0","      dfFaces$Hormone <- as.factor(dfFaces$Hormone)"
"0","      "
"0","      # create contrasts"
"0","      dfFaces <- contrastCoding(df = dfFaces, colName = ""Study"", numLevels = 4, interceptCorrect = TRUE)"
"0","      "
"0","      # create hormone contrast"
"0","      dfFaces <- contrastCodingHormone(df = dfFaces, colName = ""Hormone"", numLevels = 2, interceptCorrect = TRUE)"
"0","      "
"0","      # estimate model"
"0","      m1 <- lme(Parameter ~ 1 + contrast_AvB + contrast_ABvC + contrast_ABCvD + contrast_MvP , random = ~1|Subject, data=dfFaces)"
"0",""
"0","      # extract results"
"0","      intercept = m1$coefficients$fixed[1]"
"0","      p = summary(m1)$tTable[,""p-value""][1]"
"0","      facesIntercept[target,source] <- intercept"
"0","      facesPVal[target,source]      <- p"
"0","      dfResults[nrow(dfResults) + 1,] = list(source,target, ""faces"", ""intercept"", intercept )"
"0","      dfResults[nrow(dfResults) + 1,] = list(source,target, ""faces"", ""p"", p )"
"0","      if (p <= thres){"
"0","        dfResults[nrow(dfResults) + 1,] = list(source,target, ""faces"", ""intercept_sig"",paste(round(intercept,2),""*"") )"
"0","      } else {"
"0","        dfResults[nrow(dfResults) + 1,] = list(source,target, ""faces"", ""intercept_sig"", paste(round(intercept,2),"""") )"
"0","      }"
"0","      # create a name for the connection"
"0","      conName <- paste(regionNames[source],"">"",regionNames[target])"
"0","      dfFaces$Connection <- conName "
"0","      bigDF <- rbind(bigDF,"
"0","                     subset(dfFaces, select = c(""Subject"",""Parameter"",""Study"",""Hormone"", ""Connection"")))"
"0","    }"
"0","  }"
"0","} "
"0","print(""Intercept ="")"
"1","[1]"
"1"," ""Intercept ="""
"1","
"
"0","facesIntercept"
"1","    "
"1","       [,1]"
"1","        [,2]"
"1","        [,3]"
"1","
[1,]"
"1","         NA"
"1"," -0.18931245"
"1"," -0.02784877"
"1","
[2,]"
"1"," 0.07672545"
"1","          NA"
"1","  0.01984477"
"1","
[3,]"
"1"," 0.03837426"
"1"," -0.04862331"
"1","          NA"
"1","
"
"0","print(""p ="")"
"1","[1]"
"1"," ""p ="""
"1","
"
"0","facesPVal"
"1","    "
"1","        [,1]"
"1","         [,2]"
"1","      [,3]"
"1","
[1,]"
"1","          NA"
"1"," 3.328123e-08"
"1"," 0.4380897"
"1","
[2,]"
"1"," 0.001643191"
"1","           NA"
"1"," 0.4172336"
"1","
[3,]"
"1"," 0.113282374"
"1"," 6.335960e-02"
"1","        NA"
"1","
"
